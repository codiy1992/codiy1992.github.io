<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Codiy's Notebook – Exploit</title><link>https://note.codiy.net/docs/security/exploit/</link><description>Recent content in Exploit on Codiy's Notebook</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><atom:link href="https://note.codiy.net/docs/security/exploit/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: rhaphp</title><link>https://note.codiy.net/docs/2021/02/rhaphp/</link><pubDate>Sat, 27 Feb 2021 09:16:52 +0800</pubDate><guid>https://note.codiy.net/docs/2021/02/rhaphp/</guid><description>
&lt;h2 id="rhaphp介绍">RhaPHP介绍&lt;/h2>
&lt;ul>
&lt;li>一款半开源的微信第三方管理平台, 部分扩展功能插件是收费的.&lt;/li>
&lt;li>项目地址:&lt;a href="https://github.com/geesondog/rhaphp">https://github.com/geesondog/rhaphp&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="158版本存在的安全问题">1.5.8版本存在的安全问题&lt;/h2>
&lt;ul>
&lt;li>默认开启 info 级别日志, 日志可通过 http 请求直接下载, 下载路径 &lt;code>/runtime/log/202102/27.log&lt;/code>, info 级别日志将会包含后台登陆账号的 cookie 信息. &lt;strong>真香!!!&lt;/strong>&lt;/li>
&lt;li>存在&lt;strong>ssrf漏洞&lt;/strong>路由 &lt;code>mp/mp/addKeyword&lt;/code> POST 参数 &lt;code>keyword=abc&amp;amp;type=image&amp;amp;reply_image=dict://redis:6379/flushall&amp;amp;image_staus_type=0&lt;/code>&lt;/li>
&lt;li>可利用ssrf漏洞&lt;strong>上传任意格式文件&lt;/strong>,但无法确定保存的文件名&lt;/li>
&lt;li>RhaPHP1.5.8 版本使用的是 ThinkPHP5.1.35 框架, &lt;strong>存在反序列化利用链&lt;/strong>, 但还没找到合适的利用入口.&lt;/li>
&lt;li>图片上传仅检查后缀, 可通过 phar 文件绕过上传限制, 再配合反序列化入口函数进行爆破(但目前没有找到入口)&lt;/li>
&lt;li>上传文件直接使用的是文件md5作为文件名和路径, 可再本地模拟后获得上传后的最终路径&lt;/li>
&lt;li>低版本存在另一个ssrf漏洞, &lt;code>/mp/show/image?url=file:///etc/passwd&lt;/code>&lt;/li>
&lt;/ul></description></item><item><title>Docs: shopxo</title><link>https://note.codiy.net/docs/2021/02/shopxo/</link><pubDate>Sat, 27 Feb 2021 09:16:52 +0800</pubDate><guid>https://note.codiy.net/docs/2021/02/shopxo/</guid><description>
&lt;h2 id="shopxo介绍">shopxo介绍&lt;/h2>
&lt;ul>
&lt;li>一款半开源的企业级B2C免费开源电商系统.&lt;/li>
&lt;li>项目地址:&lt;a href="https://github.com/gongfuxiang/shopxo">https://github.com/gongfuxiang/shopxo&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="存在的安全问题">存在的安全问题&lt;/h2>
&lt;ul>
&lt;li>存在&lt;strong>ssrf漏洞&lt;/strong>和&lt;strong>反序列化利用链&lt;/strong>, 入口: &lt;code>index.php?s=/index/qrcode/download&amp;amp;url=$(echo -n 'file:///etc/passwd' | base64) | tr -d '\n'&lt;/code>&lt;/li>
&lt;li>存在许多演示站点, 默认账号密码 &lt;code>shopxo:shopxo&lt;/code>&lt;/li>
&lt;/ul></description></item></channel></rss>